            // popup label
            if (active_point) {
                var height = 25;
                var voffset = 10;
                var hoffset = 15;
                var vtoffset = 17;
                var hpadding = 5;
                ctx.font = "16px Arial";
                ctx.textAlign = "left";
                var width = ctx.measureText(labels[selected_index]).width + 2*hpadding;
                var ptx = x[selected_index];
                var pty = y[selected_index];
                var rectx = ptx + hoffset;
                var recty = pty - voffset;
                if (rectx + width > canvas_xmax) 
                    rectx = ptx + hoffset - width - 2*hoffset;
                if (recty - height < 0)
                    recty = pty + voffset;
                ctx.fillStyle = "WhiteSmoke";
                ctx.fillRect(rectx, recty, width, height);
                ctx.font = "16px Arial";
                ctx.fillStyle = "black";
                ctx.fillText(labels[selected_index], rectx + hpadding, recty + vtoffset);
            }
        }
        
        function doMouseMove(event) {
            var canvas = document.getElementById("myCanvas");
            //console.log(event.clientX-canvas.offsetLeft);
            //console.log(event.clientY-canvas.offsetTop);
            mousex = event.clientX - canvas.offsetLeft + window.scrollX;
            mousey = event.clientY - canvas.offsetTop + window.scrollY;
            active_point = false;
            for (i=0; i<npoints; i++) {
                if (in_point(x[i], y[i], r, mousex, mousey)) {
                    active_point = true;
                    selected_index = i;
                }
            }
            if (active_point & !previous_state) {
                previous_state = true;
                draw_stuff();
            }
            if (!active_point & previous_state) {
                previous_state = false;
                draw_stuff();
            }
        }
        
        -->
        </script>
    </head>
    <body onLoad=init()>

